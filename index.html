<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, viewport-fit=cover"
        />
        <meta
            http-equiv="Content-Security-Policy"
            content="default-src 'self'; img-src 'self' blob:; media-src 'self' blob:; font-src 'self'; style-src 'self'; script-src 'self'; object-src 'none'; base-uri 'self'; form-action 'self';"
        />
        <title>Marq</title>
        <link rel="manifest" href="manifest.json" />
        <link rel="stylesheet" href="css/styles.css" />
        <link rel="stylesheet" href="css/terminal.css" />
    </head>
    <body>
        <div id="terminal-container"></div>

        <!-- DOM Structure remains identical -->
        <div id="splash-screen" class="screen active">
            <div class="tadelakt-surface"></div>
            <div class="calligraphy">أهلاً</div>
        </div>
        <div id="astrolabe-screen" class="screen">
            <div class="app-title">MARQ</div>
            <div class="astrolabe-container">
                <div id="ring-intention" class="astrolabe-ring">
                    <div id="intention-serenity" class="astrolabe-marker">
                        〰
                    </div>
                    <div id="intention-vibrancy" class="astrolabe-marker">
                        ✣
                    </div>
                    <div id="intention-awe" class="astrolabe-marker">✶</div>
                    <div id="intention-legacy" class="astrolabe-marker">☗</div>
                </div>
                <div id="ring-region" class="astrolabe-ring"></div>
                <div id="ring-time" class="astrolabe-ring">
                    <div id="time-dawn" class="astrolabe-marker">◓</div>
                    <div id="time-midday" class="astrolabe-marker">☀</div>
                    <div id="time-dusk" class="astrolabe-marker">◒</div>
                    <div id="time-night" class="astrolabe-marker">☾</div>
                </div>
                <div class="astrolabe-center">
                    <span class="center-text">Align the rings</span>
                </div>
            </div>
            <div
                id="tapestry-icon"
                role="button"
                aria-label="Open Tapestry"
                tabindex="0"
            >
                ❖
            </div>
        </div>
        <div id="tapestry-screen" class="screen">
            <canvas id="tapestry-canvas"></canvas>
            <canvas id="map-canvas"></canvas>
            <div class="tapestry-header">
                <div class="tapestry-title">The Tapestry of Time</div>
                <div class="tapestry-subtitle">Your Woven Journey</div>
            </div>
            <div
                class="back-button"
                id="tapestry-back"
                role="button"
                aria-label="Go Back"
                tabindex="0"
            >
                ←
            </div>
            <div class="alchemy-ui" id="alchemy-ui">
                <div class="alchemy-slot" id="alchemy-slot-1">1</div>
                <button class="alchemy-fuse-btn" id="alchemy-fuse-btn" disabled>
                    FUSE
                </button>
                <div class="alchemy-slot" id="alchemy-slot-2">2</div>
            </div>
            <div class="tapestry-actions">
                <button class="tapestry-btn" id="horizon-toggle">
                    Horizon Mode
                </button>
                <button class="tapestry-btn" id="map-toggle">
                    Map Overwatch
                </button>
                <button class="tapestry-btn" id="aegis-toggle">
                    Aegis HUD
                </button>

                <div class="button-group">
                    <button class="tapestry-btn" id="forge-shard">
                        Forge Shard
                    </button>
                    <button class="tapestry-btn" id="scan-shard">
                        Scan Shard
                    </button>
                </div>
                <input
                    type="file"
                    id="shard-input"
                    accept="image/png"
                    class="hidden-input"
                    hidden
                />
                <input
                    type="file"
                    id="sonic-shard-input"
                    accept="audio/wav"
                    class="hidden-input"
                    hidden
                />

                <button class="tapestry-btn" id="export-scroll">
                    Export Scroll
                </button>
                <input
                    type="file"
                    id="import-scroll"
                    accept=".json"
                    class="hidden-input"
                    hidden
                />
                <button class="tapestry-btn" id="import-btn">
                    Import Scroll
                </button>
                <button class="tapestry-btn" id="clear-tapestry">
                    Unravel
                </button>
            </div>
            <div class="horizon-dashboard" id="horizon-dashboard">
                <div class="horizon-header">Strategic Analysis</div>
                <div class="horizon-stat">
                    <span class="stat-label">Dominance</span>
                    <span class="stat-value" id="horizon-dominance">--</span>
                </div>
                <div class="horizon-stat">
                    <span class="stat-label">Balance</span>
                    <div class="stat-bar">
                        <div class="stat-fill" id="horizon-balance-bar"></div>
                    </div>
                </div>
                <div class="horizon-insight" id="horizon-insight">
                    Analyzing trajectory...
                </div>
            </div>
            <div class="aegis-hud" id="aegis-hud">
                <!-- Populated by AegisEngine -->
            </div>
        </div>
        <div id="riad-screen" class="screen">
            <div id="riad-image-container">
                <img id="riad-image-element" src="" alt="" />
            </div>
            <div
                id="back-button"
                role="button"
                aria-label="Go Back"
                tabindex="0"
            >
                ←
            </div>
            <div
                id="weave-button"
                class="weave-button"
                role="button"
                aria-label="Weave Thread"
                tabindex="0"
            >
                Weave a Thread
                <div class="weave-progress"></div>
            </div>
            <div class="riad-content">
                <h1 id="riad-title"></h1>
                <h2 id="riad-subtitle"></h2>
                <p id="riad-narrative"></p>
                <div class="sensory-palette">
                    <div class="sensory-item" id="sensory-sight">
                        <span class="sensory-icon">◉</span
                        ><span
                            class="sensory-description"
                            id="sensory-sight-desc"
                        ></span>
                    </div>
                    <div class="sensory-item" id="sensory-sound">
                        <span class="sensory-icon">♫</span
                        ><span
                            class="sensory-description"
                            id="sensory-sound-desc"
                        ></span>
                    </div>
                    <div class="sensory-item" id="sensory-scent">
                        <span class="sensory-icon">☙</span
                        ><span
                            class="sensory-description"
                            id="sensory-scent-desc"
                        ></span>
                    </div>
                    <div class="sensory-item" id="sensory-touch">
                        <span class="sensory-icon">✍</span
                        ><span
                            class="sensory-description"
                            id="sensory-touch-desc"
                        ></span>
                    </div>
                </div>
                <div class="foundation-toggle">
                    <h3>The Foundation</h3>
                    <span class="plus-icon">+</span>
                </div>
                <div class="foundation-details">
                    <p id="foundation-text"></p>
                </div>
            </div>
        </div>
        <div class="color-wash"></div>

        <script type="module" src="js/crypto-guard.js"></script>
        <script type="module" src="js/spectra.js"></script>
        <script type="module" src="js/app.js"></script>
    </body>
</html>
